<!DOCTYPE html>
{% load static %}
{% load mytag %}
<html lang="fr">

<head>
    <meta charset="utf-8">
    <title>Statistiques</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link rel="icon" href="{% static 'img/logo.png' %}" type="image/png" />

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="{% static 'lib/owlcarousel/assets/owl.carousel.min.css' %}" rel="stylesheet">
    <link href="{% static 'lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css' %}" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="{% static 'css/style.css' %}" rel="stylesheet">

    <style>
        .sidebar {
            min-width: 250px;
            max-width: 250px;
            height: 100vh;
            position: fixed;
            z-index: 1;
            top: 0;
            left: 0;
            overflow-x: hidden;
            padding-top: 20px;
        }
        .plotly-graph-container {
            position: absolute;
            top: 0;
            left: 250px; 
            right: 0;
            bottom: 0;
        }
        .main {
            margin-left: 250px;
            padding: 0px 10px;
            height: 100vh;
            overflow-y: auto;
            background-color: white; 
        }
        @media screen and (max-width: 700px) {
          .sidebar {
            width: 100%;
            height: auto;
            position: relative;
          }
          .sidebar a {float: left;}
          .main {margin-left: 0;}
        }
        @media screen and (max-width: 400px) {
          .sidebar a {
            text-align: center;
            float: none;
          }
        }
    </style>
     <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
     <script>
        document.addEventListener('DOMContentLoaded', function () {
    var data = JSON.parse("{{ data|escapejs }}");
    console.log(data);

    var labels = data.map(function (item) { return item.Procédure; });
    var valeursGenerales = data.map(function (item) { return item.doute_general; });
    var valeursConfirmees = data.map(function (item) { return item.doute_confirme; });
    var valeursRejetees = data.map(function (item) { return item.doute_rejete; });

    var ctx = document.getElementById('veoservices-chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'Doute Général',
                    data: valeursGenerales,
                    backgroundColor: 'rgba(255, 99, 132, 0.5)'
                },
                {
                    label: 'Doute Confirmé',
                    data: valeursConfirmees,
                    backgroundColor: 'rgba(54, 162, 235, 0.5)'
                },
                {
                    label: 'Doute Rejeté',
                    data: valeursRejetees,
                    backgroundColor: 'rgba(75, 192, 192, 0.5)'
                }
            ]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                },
                x: {
                    stacked: false 
                }
            }
        }
    });
});

    </script>
</head>

<body style="background-color: white;"> 

<!-- Sidebar Start -->
<div class="sidebar pe-4 pb-3">
    <nav class="navbar bg-light navbar-light">
        
        <div class="navbar-brand mx-4 mb-3" style="display: flex; flex-direction: column; align-items: center; width: 100%; height: auto;">
            <a href="/home">
                <img src="{% static 'img/logo.png' %}" alt="" style="width: 120px; height: 100px;">
            </a>
            {% if user.is_authenticated %}
              
                <div style="display: flex; align-items: center;">
                    <p style="margin-top: 10px; margin-bottom: 0;">Bonjour, {{ user_name }}</p>
                </div>
            {% endif %}
        </div>
        <div class="navbar-nav w-100">
            <a href="/home" class="nav-item nav-link"><i class="fa fa-home me-2"></i>Accueil</a>
            <a href="/dt" class="nav-item nav-link" style="white-space: nowrap;">
                <i class="fa fa-hourglass-start me-2"></i>
                Dossier à traiter<span class="badge rounded-pill badge-notification bg-danger" style="margin-left: 5px; vertical-align: middle;">{% get_total_a_traiter %}</span>
            </a>
            <a href="/dtraités" class="nav-item nav-link"><i class="fa fa-th me-2"></i>Dossier traité</a>
            {% if SupUse == True %}
                <a href="/home_test" class="nav-item nav-link"><i class="fa fa-clipboard-list me-2"></i>Espace Recette</a>
                <a href="/admin" class="nav-item nav-link"><i class="fa fa-user-cog me-2"></i>Admin</a>
            {% endif %}
            <a href="/dashboard" class="nav-item nav-link active"><i class="fa fa-chart-line me-2"></i>Statistique</a>
            <a href="/logout/" class="nav-item nav-link"><i class="fas fa-sign-out-alt me-2"></i>Déconnexion</a>
        </div>
    </nav>
</div>
<!-- Sidebar End -->


    <div class="main">
        <h1>Répartition des dossiers par procédure et statut de doute</h1>
       <canvas id="veoservices-chart" width="800" height="400"></canvas>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'lib/chart/chart.min.js' %}"></script>
    <script src="{% static 'lib/easing/easing.min.js' %}"></script>
    <script src="{% static 'lib/waypoints/waypoints.min.js' %}"></script>
    <script src="{% static 'lib/owlcarousel/owl.carousel.min.js' %}"></script>
    <script src="{% static 'lib/tempusdominus/js/moment.min.js' %}"></script>
    <script src="{% static 'lib/tempusdominus/js/moment-timezone.min.js' %}"></script>
    <script src="{% static 'lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js' %}"></script>

    <!-- Template Javascript -->
    <!-- <script src="{% static 'js/main.js' %}"></script> -->
</body>

</html>
